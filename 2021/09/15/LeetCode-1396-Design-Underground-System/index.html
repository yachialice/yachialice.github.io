<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="LeetCode-1396. Design Underground System"><meta name="keywords" content="Leetcode"><meta name="author" content="Yachialice"><meta name="copyright" content="Yachialice"><title>LeetCode-1396. Design Underground System | Yachialice</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#LeetCode-1396-Design-Underground-System"><span class="toc-number">1.</span> <span class="toc-text">LeetCode-1396. Design Underground System</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Description"><span class="toc-number">1.1.</span> <span class="toc-text">Description</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://i.loli.net/2021/03/06/lfBCnzNsjHxPIXw.jpg"></div><div class="author-info__name text-center">Yachialice</div><div class="author-info__description text-center">Yachialice's Blog</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/yachialice">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">177</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">9</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">42</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://tva1.sinaimg.cn/large/008eGmZEgy1goa52nmaxvj31400u07dr.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Yachialice</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">LeetCode-1396. Design Underground System</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-09-15</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Leetcode/">Leetcode</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Leetcode/Complicated-Data-Structure/">Complicated Data Structure</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="LeetCode-1396-Design-Underground-System"><a href="#LeetCode-1396-Design-Underground-System" class="headerlink" title="LeetCode-1396. Design Underground System"></a>LeetCode-1396. Design Underground System</h1><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/design-underground-system/">https://leetcode.com/problems/design-underground-system/</a></p>
<p>An underground railway system is keeping track of customer travel times between different stations. They are using this data to calculate the average time it takes to travel from one station to another.</p>
<p>Implement the <code>UndergroundSystem</code> class:</p>
<ul>
<li><p>```<br>void checkIn(int id, string stationName, int t)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - A customer with a card ID equal to &#96;id&#96;, checks in at the station &#96;stationName&#96; at time &#96;t&#96;.</span><br><span class="line">  - A customer can only be checked into one place at a time.</span><br><span class="line"></span><br><span class="line">- &#96;&#96;&#96;</span><br><span class="line">  void checkOut(int id, string stationName, int t)</span><br></pre></td></tr></table></figure>

<ul>
<li>A customer with a card ID equal to <code>id</code>, checks out from the station <code>stationName</code> at time <code>t</code>.</li>
</ul>
</li>
<li><p>```<br>double getAverageTime(string startStation, string endStation)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - Returns the average time it takes to travel from &#96;startStation&#96; to &#96;endStation&#96;.</span><br><span class="line">  - The average time is computed from all the previous traveling times from &#96;startStation&#96; to &#96;endStation&#96; that happened **directly**, meaning a check in at &#96;startStation&#96; followed by a check out from &#96;endStation&#96;.</span><br><span class="line">  - The time it takes to travel from &#96;startStation&#96; to &#96;endStation&#96; **may be different** from the time it takes to travel from &#96;endStation&#96; to &#96;startStation&#96;.</span><br><span class="line">  - There will be at least one customer that has traveled from &#96;startStation&#96; to &#96;endStation&#96; before &#96;getAverageTime&#96; is called.</span><br><span class="line"></span><br><span class="line">You may assume all calls to the &#96;checkIn&#96; and &#96;checkOut&#96; methods are consistent. If a customer checks in at time &#96;t1&#96; then checks out at time &#96;t2&#96;, then &#96;t1 &lt; t2&#96;. All events happen in chronological order.</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">**Example 1:**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Input<br>[“UndergroundSystem”,”checkIn”,”checkIn”,”checkIn”,”checkOut”,”checkOut”,”checkOut”,”getAverageTime”,”getAverageTime”,”checkIn”,”getAverageTime”,”checkOut”,”getAverageTime”]<br>[[],[45,”Leyton”,3],[32,”Paradise”,8],[27,”Leyton”,10],[45,”Waterloo”,15],[27,”Waterloo”,20],[32,”Cambridge”,22],[“Paradise”,”Cambridge”],[“Leyton”,”Waterloo”],[10,”Leyton”,24],[“Leyton”,”Waterloo”],[10,”Waterloo”,38],[“Leyton”,”Waterloo”]]</p>
</li>
</ul>
<p>Output<br>[null,null,null,null,null,null,null,14.00000,11.00000,null,11.00000,null,12.00000]</p>
<p>Explanation<br>UndergroundSystem undergroundSystem = new UndergroundSystem();<br>undergroundSystem.checkIn(45, “Leyton”, 3);<br>undergroundSystem.checkIn(32, “Paradise”, 8);<br>undergroundSystem.checkIn(27, “Leyton”, 10);<br>undergroundSystem.checkOut(45, “Waterloo”, 15);  // Customer 45 “Leyton” -&gt; “Waterloo” in 15-3 = 12<br>undergroundSystem.checkOut(27, “Waterloo”, 20);  // Customer 27 “Leyton” -&gt; “Waterloo” in 20-10 = 10<br>undergroundSystem.checkOut(32, “Cambridge”, 22); // Customer 32 “Paradise” -&gt; “Cambridge” in 22-8 = 14<br>undergroundSystem.getAverageTime(“Paradise”, “Cambridge”); // return 14.00000. One trip “Paradise” -&gt; “Cambridge”, (14) / 1 = 14<br>undergroundSystem.getAverageTime(“Leyton”, “Waterloo”);    // return 11.00000. Two trips “Leyton” -&gt; “Waterloo”, (10 + 12) / 2 = 11<br>undergroundSystem.checkIn(10, “Leyton”, 24);<br>undergroundSystem.getAverageTime(“Leyton”, “Waterloo”);    // return 11.00000<br>undergroundSystem.checkOut(10, “Waterloo”, 38);  // Customer 10 “Leyton” -&gt; “Waterloo” in 38-24 = 14<br>undergroundSystem.getAverageTime(“Leyton”, “Waterloo”);    // return 12.00000. Three trips “Leyton” -&gt; “Waterloo”, (10 + 12 + 14) / 3 = 12</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**Example 2:**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Input<br>[“UndergroundSystem”,”checkIn”,”checkOut”,”getAverageTime”,”checkIn”,”checkOut”,”getAverageTime”,”checkIn”,”checkOut”,”getAverageTime”]<br>[[],[10,”Leyton”,3],[10,”Paradise”,8],[“Leyton”,”Paradise”],[5,”Leyton”,10],[5,”Paradise”,16],[“Leyton”,”Paradise”],[2,”Leyton”,21],[2,”Paradise”,30],[“Leyton”,”Paradise”]]</p>
<p>Output<br>[null,null,null,5.00000,null,null,5.50000,null,null,6.66667]</p>
<p>Explanation<br>UndergroundSystem undergroundSystem = new UndergroundSystem();<br>undergroundSystem.checkIn(10, “Leyton”, 3);<br>undergroundSystem.checkOut(10, “Paradise”, 8); // Customer 10 “Leyton” -&gt; “Paradise” in 8-3 = 5<br>undergroundSystem.getAverageTime(“Leyton”, “Paradise”); // return 5.00000, (5) / 1 = 5<br>undergroundSystem.checkIn(5, “Leyton”, 10);<br>undergroundSystem.checkOut(5, “Paradise”, 16); // Customer 5 “Leyton” -&gt; “Paradise” in 16-10 = 6<br>undergroundSystem.getAverageTime(“Leyton”, “Paradise”); // return 5.50000, (5 + 6) / 2 = 5.5<br>undergroundSystem.checkIn(2, “Leyton”, 21);<br>undergroundSystem.checkOut(2, “Paradise”, 30); // Customer 2 “Leyton” -&gt; “Paradise” in 30-21 = 9<br>undergroundSystem.getAverageTime(“Leyton”, “Paradise”); // return 6.66667, (5 + 6 + 9) / 3 = 6.66667</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">**Constraints:**</span><br><span class="line"></span><br><span class="line">- &#96;1 &lt;&#x3D; id, t &lt;&#x3D; 106&#96;</span><br><span class="line">- &#96;1 &lt;&#x3D; stationName.length, startStation.length, endStation.length &lt;&#x3D; 10&#96;</span><br><span class="line">- All strings consist of uppercase and lowercase English letters and digits.</span><br><span class="line">- There will be at most &#96;2 * 104&#96; calls **in total** to &#96;checkIn&#96;, &#96;checkOut&#96;, and &#96;getAverageTime&#96;.</span><br><span class="line">- Answers within &#96;10-5&#96; of the actual value will be accepted.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## Solution</span><br><span class="line"></span><br><span class="line">（1）unordered_map&lt;int, pair&lt;string, int&gt;&gt; checkIn_rec：映射check in时的id-&gt;&#123;stationName， time&#125;</span><br><span class="line"></span><br><span class="line">（2）map&lt;pair&lt;string, string&gt;, vector&lt;int&gt;&gt; time_rec：映射&#123;startStation, endStation&#125; -&gt;使用时间的队列。这里使用map是因为unordered_map不支持使用pair作key。</span><br><span class="line"></span><br><span class="line">（3）主要思路是，check in的时候保存记录到checkIn_rec中；check_out的时候，根据id寻找checkIn的信息，更新time_rec</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;c++</span><br><span class="line">class UndergroundSystem &#123;</span><br><span class="line">public:</span><br><span class="line">    UndergroundSystem() &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    void checkIn(int id, string stationName, int t) &#123;</span><br><span class="line">        checkIn_rec[id] &#x3D; &#123;stationName, t&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    void checkOut(int id, string stationName, int t) &#123;</span><br><span class="line">        string startStation &#x3D; checkIn_rec[id].first;</span><br><span class="line">        int startTime &#x3D; checkIn_rec[id].second;</span><br><span class="line">        checkIn_rec.erase(id);</span><br><span class="line">        </span><br><span class="line">        if(time_rec.count(&#123;startStation, stationName&#125;) !&#x3D; 0)</span><br><span class="line">            time_rec[&#123;startStation, stationName&#125;].push_back(t - startTime);</span><br><span class="line">        else</span><br><span class="line">            time_rec[&#123;startStation, stationName&#125;] &#x3D; &#123;t - startTime&#125;;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    double getAverageTime(string startStation, string endStation) &#123;</span><br><span class="line">        int averageTime &#x3D; 0;</span><br><span class="line">        auto times &#x3D; time_rec[&#123;startStation, endStation&#125;];</span><br><span class="line">        for (auto t : times)&#123;</span><br><span class="line">            averageTime +&#x3D; t;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return averageTime &#x2F; (times.size()*1.0);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">private:</span><br><span class="line">    unordered_map&lt;int, pair&lt;string, int&gt;&gt; checkIn_rec;</span><br><span class="line">    map&lt;pair&lt;string, string&gt;, vector&lt;int&gt;&gt; time_rec;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Yachialice</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2021/09/15/LeetCode-1396-Design-Underground-System/">http://example.com/2021/09/15/LeetCode-1396-Design-Underground-System/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Leetcode/">Leetcode</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/09/27/Leetcode-198-House-Robber/"><i class="fa fa-chevron-left">  </i><span>Leetcode-198. House Robber</span></a></div><div class="next-post pull-right"><a href="/2021/09/15/LeetCode-981-Time-Based-Key-Value-Store/"><span>LeetCode-981. Time Based Key-Value Store</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://tva1.sinaimg.cn/large/008eGmZEgy1goa52nmaxvj31400u07dr.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By Yachialice</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>